diff -u OTW.TXT OTWC
--- OTW.TXT
+++ OTWC
@@ -26,10 +26,16 @@
 DIM WIN_AY     [0]
 DIM WIN_AW     [0]
 DIM WIN_AH     [0]
+DIM WIN_RX     [0]
+DIM WIN_RY     [0]
+DIM WIN_RFX    [0]
+DIM WIN_RFY    [0]
 DIM WIN_FX     [0]
 DIM WIN_FY     [0]
-DIM WIN_FWIDTH [0]
-DIM WIN_FHEIGHT[0]
+DIM WIN_FW1    [0]
+DIM WIN_FH1    [0]
+DIM WIN_FW2    [0]
+DIM WIN_FH2    [0]
 DIM WIN_CTL    [0]
 DIM WIN_PID    [0]
 DIM WIN_NUPID  [0]
@@ -96,10 +102,16 @@
  WIN_AY        =NewArray(WIN_MAX)
  WIN_AW        =NewArray(WIN_MAX)
  WIN_AH        =NewArray(WIN_MAX)
+ WIN_RX        =NewArray(WIN_MAX)
+ WIN_RY        =NewArray(WIN_MAX)
+ WIN_RFX       =NewArray(WIN_MAX)
+ WIN_RFY       =NewArray(WIN_MAX)
  WIN_FX        =NewArray(WIN_MAX)
  WIN_FY        =NewArray(WIN_MAX)
- WIN_FWIDTH    =NewArray(WIN_MAX)
- WIN_FHEIGHT   =NewArray(WIN_MAX)
+ WIN_FW1       =NewArray(WIN_MAX)
+ WIN_FH1       =NewArray(WIN_MAX)
+ WIN_FW2       =NewArray(WIN_MAX)
+ WIN_FH2       =NewArray(WIN_MAX)
  WIN_CTL       =NewArray(WIN_MAX)
  WIN_PID       =NewArray(WIN_MAX)
  WIN_NUPID     =NewArray(WIN_MAX)
@@ -360,24 +372,42 @@
  WIN_Y[NUWID]=Y
  
  WIN_AX[NUWID]=WIN_AX[PNUWID]+X
- WIN_AY[NUWID]=WIN_AX[PNUWID]+Y '
- WIN_FX[NUWID]=WIN_AX[NUWID]+CTL_FW1[NC]
- WIN_FY[NUWID]=WIN_AX[NUWID]+CTL_FH1[NC]
- WIN_WIDTH[NUWID]=WIDTH
- WIN_HEIGHT[NUWID]=HEIGHT
- WIN_FWIDTH[NUWID]=WIDTH+CTL_FW2[NC]
- WIN_FHEIGHT[NUWID]=HEIGHT+CTL_FH2[NC]
- WIN_AW[NUWID]=WIDTH
- WIN_AH[NUWID]=HEIGHT
+ WIN_AY[NUWID]=WIN_AY[PNUWID]+Y '
+ WIN_FW1[NUWID]=CTL_FW1[NC]
+ WIN_FH1[NUWID]=CTL_FH1[NC]
+ WIN_FW2[NUWID]=CTL_FW1[NC]+CTL_FW2[NC]
+ WIN_FH2[NUWID]=CTL_FH1[NC]+CTL_FH2[NC]
+ WIN_WIDTH[NUWID]=WIDTH+WIN_FW2[NUWID]
+ WIN_HEIGHT[NUWID]=HEIGHT+WIN_FH2[NUWID]
+ WIN_AW[NUWID]=WIN_WIDTH[NUWID]
+ WIN_AH[NUWID]=WIN_HEIGHT[NUWID]
+ WIN_FX[NUWID]=WIN_AX[NUWID]+WIN_FW1[NUWID]
+ WIN_FY[NUWID]=WIN_AY[NUWID]+WIN_FH1[NUWID]
+ WIN_RFX[NUWID]=WIN_FX[NUWID]
+ WIN_RFY[NUWID]=WIN_FY[NUWID]
+ WIN_RX[NUWID]=WIN_AX[NUWID]
+ WIN_RY[NUWID]=WIN_AY[NUWID]
+ IF WIN_FX[PNUWID]>WIN_RX[NUWID]THEN
+  WIN_RX[NUWID]=WIN_FX[PNUWID]
+ ENDIF
+ IF WIN_FY[PNUWID]>WIN_RY[NUWID]THEN
+  WIN_RY[NUWID]=WIN_FY[PNUWID]
+ ENDIF
  VAR E1=WIN_AX[NUWID]+WIDTH
  VAR E2=WIN_AX[PNUWID]+WIN_AW[PNUWID]
  IF E1>E2 THEN
   DEC WIN_AW[NUWID],E1-E2
+  IF WIN_RFX[PNUWID]>WIN_RFX[NUWID]THEN
+   WIN_RFX[NUWID]=WIN_RFX[PNUWID]
+  ENDIF
  ENDIF
  E1=WIN_AY[NUWID]+HEIGHT
  E2=WIN_AY[PNUWID]+WIN_AH[PNUWID]
  IF E1>E2 THEN
   DEC WIN_AH[NUWID],E1-E2
+  IF WIN_RFY[PNUWID]>WIN_RFY[NUWID]THEN
+   WIN_RFY[NUWID]=WIN_RFY[PNUWID]
+  ENDIF
  ENDIF
  WIN_NEXT[NUWID]=0
  WIN_PARENT[NUWID]=PARENT AND NUWIDMASK
@@ -439,10 +469,11 @@
  WIN_AX[NUWID]=WIN_TopLevelX
  WIN_AY[NUWID]=WIN_TOPLEVELY
  '
+ VAR NUCID=CTL AND 4095
  WIN_WIDTH[NUWID]=WIDTH
  WIN_HEIGHT[NUWID]=HEIGHT
- WIN_FWIDTH[NUWID]=WIDTH
- WIN_FHEIGHT[NUWID]=HEIGHT
+ WIN_FW2[NUWID]=CTL_FW1[NUCID]+CTL_FW2[NUCID]
+ WIN_FH2[NUWID]=CTL_FH1[NUCID]+CTL_FH2[NUCID]
  WIN_NEXT[NUWID]=0
  GCLIP 1,0,240,400,480
  VOID RepaintWindow(WND)
@@ -489,11 +520,18 @@
  WIN_TopLevelY=WIN_TopLevelY+8
  WIN_TopLevelX=WIN_TopLevelX+8
  WIN_TopLevelY=WIN_TopLevelY+8
- WIN_FX[NUWID]=WIN_TopLevelX
- WIN_FY[NUWID]=WIN_TOPLEVELY
+ WIN_FW1[NUWID]=CTL_FW1[NUCID]'WIN_TopLevelX
+ WIN_FH1[NUWID]=CTL_FH1[NUCID]'WIN_TOPLEVELY
  WIN_AX[NUWID]=WIN_TopLevelX
  WIN_AY[NUWID]=WIN_TOPLEVELY-WIN_FHEIGHT1
- 
+ WIN_RX[NUWID]=WIN_AX[NUWID]
+ WIN_RY[NUWID]=WIN_AY[NUWID]
+ WIN_FX[NUWID]=WIN_AX[NUWID]+WIN_FW1[NUWID]
+ WIN_FY[NUWID]=WIN_AY[NUWID]+WIN_FH1[NUWID]
+ WIN_RFX[NUWID]=WIN_AX[NUWID]+WIN_FW1[NUWID]
+ WIN_RFY[NUWID]=WIN_AY[NUWID]+WIN_FH1[NUWID]
+ WIN_RX[NUWID]=WIN_AX[NUWID]
+ WIN_RY[NUWID]=WIN_AY[NUWID]
 ' WIN_WIDTH[NUWID]=WIDTH+WIN_FWIDTH+
 ' WIN_HEIGHT[NUWID]=HEIGHT
  
@@ -531,8 +569,8 @@
 DEF OTW_DrawMap NUWID
  GPAGE OTW_SP,OTW_DP
  GCLIP 1,0,240,400,480
- GFILL WIN_AX[NUWID],WIN_AY[NUWID]+240,WIN_AX[NUWID]+WIN_WIDTH[NUWID],WIN_AY[NUWID]+WIN_HEIGHT[NUWID]+240,ShortToRGB(WIN_FRAMEFLG OR NUWID)
- GFILL WIN_FX[NUWID],WIN_FY[NUWID]+240,WIN_FX[NUWID]+WIN_FWIDTH[NUWID],WIN_FY[NUWID]+WIN_FHEIGHT[NUWID]+240,ShortToRGB(NUWID)
+ GFILL WIN_RX[NUWID],WIN_RY[NUWID]+240,WIN_RX[NUWID]+WIN_AW[NUWID],WIN_RY[NUWID]+WIN_AH[NUWID]+240,ShortToRGB(WIN_FRAMEFLG OR NUWID)
+ GFILL WIN_RFX[NUWID],WIN_RFY[NUWID]+240,WIN_RFX[NUWID]+WIN_AW[NUWID]-WIN_FW2[NUWID],WIN_RFY[NUWID]+240+WIN_AH[NUWID]-WIN_FH2[NUWID],ShortToRGB(NUWID)
  GCLIP 1,0,0,400,240
 END
 COMMON DEF FrontWindow(WND)
@@ -569,11 +607,32 @@
      SPOFS WIN_SP[NUWID]>>10,,,Z2+1'1
      SPOFS WIN_SP[C]>>10,,,Z+1'1
     ENDIF
+    VOID RepaintWindow(WND)
+    OTW_DrawMap NUWID
+    IF WIN_CHILD[NUWID]THEN
+     VAR B=WIN_CHILD[NUWID]
+     WHILE B
+      VOID RepaintWindow(B OR(WIN_WID[B]<<WIDSHIFT))
+      OTW_DrawMap B
+      IF!WIN_NEXT[B]THEN
+       WHILE B
+        B=WIN_PARENT[B]
+        IF B==NUWID THEN BREAK
+        IF WIN_NEXT[B]THEN B=WIN_NEXT[B]:BREAK
+       WEND
+       IF B==NUWID THEN BREAK
+      ENDIF
+      IF WIN_CHILD[B]THEN
+       B=WIN_CHILD[B]
+       CONTINUE
+      ENDIF
+      B=WIN_NEXT[B]
+      IF B==NUWID THEN BREAK
+     WEND
+    ENDIF
     BREAK
    ENDIF
   WEND
- VOID RepaintWindow(WND)
- OTW_DrawMap NUWID
  RETURN 0
 END
 COMMON DEF MoveWindow(WND,X,Y)
@@ -582,17 +641,70 @@
  VAR NUWID=WND AND NUWIDMASK
  VAR MX=X-WIN_AX[NUWID],MY=Y-WIN_AY[NUWID]
  VAR NXT=WIN_CHILD[NUWID],B=NXT
- GFILL WIN_AX[NUWID],WIN_AY[NUWID],WIN_AX[NUWID]+WIN_WIDTH[NUWID],WIN_AY[NUWID]+WIN_HEIGHT[NUWID],0
+ IF WIN_PARENT[NUWID]==(WIN_ROOTWND AND NUWIDMASK)THEN
+  GFILL WIN_RX[NUWID],WIN_RY[NUWID],WIN_RX[NUWID]+WIN_AW[NUWID],WIN_RY[NUWID]+WIN_AH[NUWID],0
+ ENDIF
+' GFILL WIN_AX[NUWID],WIN_AY[NUWID],WIN_AX[NUWID]+WIN_WIDTH[NUWID],WIN_AY[NUWID]+WIN_HEIGHT[NUWID],0
  WIN_AX[NUWID]=WIN_AX[NUWID]+MX
  WIN_AY[NUWID]=WIN_AY[NUWID]+MY
- WIN_FX[NUWID]=WIN_FX[NUWID]+MX
- WIN_FY[NUWID]=WIN_FY[NUWID]+MY
+ WIN_FX[NUWID]=WIN_AX[NUWID]+WIN_FW1[NUWID]
+ WIN_FY[NUWID]=WIN_AY[NUWID]+WIN_FH1[NUWID]
+ WIN_RFX[NUWID]=WIN_FX[NUWID]
+ WIN_RFY[NUWID]=WIN_FY[NUWID]
+ WIN_RX[NUWID]=WIN_AX[NUWID]
+ WIN_RY[NUWID]=WIN_AY[NUWID]
+ VAR PNUWID=WIN_PARENT[NUWID]
+ IF WIN_FX[PNUWID]>WIN_RX[NUWID]THEN
+  WIN_RX[NUWID]=WIN_FX[PNUWID]
+  IF WIN_RFX[PNUWID]>WIN_RFX[NUWID]THEN
+   WIN_RFX[NUWID]=WIN_RFX[PNUWID]
+  ENDIF
+ ENDIF
+ IF WIN_FY[PNUWID]>WIN_RY[NUWID]THEN
+  WIN_RY[NUWID]=WIN_FY[PNUWID]
+  IF WIN_RFY[PNUWID]>WIN_RFY[NUWID]THEN
+   WIN_RFY[NUWID]=WIN_RFY[PNUWID]
+  ENDIF
+ ENDIF
+ VAR E1=WIN_AX[NUWID]+WIN_WIDTH[NUWID]
+ VAR E2=WIN_RX[PNUWID]+WIN_AW[PNUWID]
+
+ WIN_AW[NUWID]=WIN_WIDTH[NUWID]
+ IF E1>E2 THEN
+ DEC WIN_AW[NUWID],E1-E2
+ ENDIF
+ IF WIN_AX[NUWID]<WIN_FX[PNUWID]THEN
+ WIN_AW[NUWID]=WIN_WIDTH[NUWID]
+  DEC WIN_AW[NUWID],WIN_FX[PNUWID]-WIN_AX[NUWID]
+ ENDIF
+ E1=WIN_RY[NUWID]+WIN_HEIGHT[NUWID]
+ E2=WIN_RY[PNUWID]+WIN_AH[PNUWID]
+ WIN_AH[NUWID]=WIN_HEIGHT[NUWID]
+
+ IF E1>E2 THEN
+  DEC WIN_AH[NUWID],E1-E2
+ ENDIF
+ IF WIN_AY[NUWID]<WIN_FY[PNUWID]THEN
+ WIN_AH[NUWID]=WIN_HEIGHT[NUWID]
+  DEC WIN_AH[NUWID],WIN_FY[PNUWID]-WIN_AY[NUWID]
+ ENDIF
+' STOP
+' WIN_AH[NUWID]=WIN_HEIGHT[NUWID]
+' IF WIN_AX[PNUWID]>WIN_RX[NUWID]THEN
+' WIN_RX[NUWID]=WIN_AX[PNUWID]
+'ENDIF
+'IF WIN_AY[PNUWID]>WIN_RY[NUWID]THEN
+' WIN_RY[NUWID]=WIN_AY[PNUWID]
+'ENDIF
+'IALOG STR$(WIN_FX[PNUWID]-WIN_AX[NUWID])
  VAR E=FrontWindow(WND)
  IF E THEN RETURN E
  'WHILE 1
 ' 
 'WEND
  NXT=WIN_CHILD[WIN_PARENT[NUWID]]
+ VOID RepaintWindow(WIN_PARENT[NUWID]OR(WIN_WID[WIN_PARENT[NUWID]]<<WIDSHIFT))
+
  IF!NXT THEN RETURN'WIN_
  B=NXT
  IF WIN_PARENT[NUWID]==(WIN_ROOTWND AND NUWIDMASK) THEN
@@ -605,9 +717,43 @@
  WHILE NXT
   VOID RepaintWindow(NXT OR(WIN_WID[NXT]<<WIDSHIFT))
   OTW_DrawMap NXT
+  IF WIN_CHILD[NXT]THEN
+   B=WIN_CHILD[NXT]
+   VAR MVF=NUWID==NXT
+   WHILE B
+    IF MVF THEN
+     WIN_AX[B]=WIN_AX[B]+MX
+     WIN_AY[B]=WIN_AY[B]+MY
+     WIN_FX[B]=WIN_FX[B]+MX
+     WIN_FY[B]=WIN_FY[B]+MY
+     WIN_RFX[B]=WIN_RFX[B]+MX
+     WIN_RFY[B]=WIN_RFY[B]+MY
+     WIN_RX[B]=WIN_RX[B]+MX
+     WIN_RY[B]=WIN_RY[B]+MY
+    ENDIF
+    VOID RepaintWindow(B OR(WIN_WID[B]<<WIDSHIFT))
+    OTW_DrawMap B
+    IF!WIN_NEXT[B]THEN
+     WHILE B
+      B=WIN_PARENT[B]
+      IF B==NXT THEN BREAK
+      IF WIN_NEXT[B]THEN B=WIN_NEXT[B]:BREAK
+     WEND
+     IF B==NXT THEN BREAK
+    ENDIF
+    IF WIN_CHILD[B]THEN
+     B=WIN_CHILD[B]
+     CONTINUE
+    ENDIF
+    B=WIN_NEXT[B]
+    IF B==NXT THEN BREAK
+   WEND
+  ENDIF
   NXT=WIN_NEXT[NXT]
+'  IF NXT==NUWID THEN BREAK
  WEND
- 
+
+RETURN 0
  NXT=WIN_CHILD[NUWID]:B=NXT
  VAR PAX2=WIN_X[NUWID]+WIN_AW[NUWID]
  VAR PAY2=WIN_Y[NUWID]+WIN_AH[NUWID]
@@ -618,8 +764,16 @@
   WIN_AY[B]=WIN_AY[B]+MY
   WIN_FX[B]=WIN_FX[B]+MX
   WIN_FY[B]=WIN_FY[B]+MY
+  WIN_RFX[B]=WIN_RFX[B]+MX
+  WIN_RFY[B]=WIN_RFY[B]+MY
+  WIN_RX[B]=WIN_RX[B]+MX
+  WIN_RY[B]=WIN_RY[B]+MY
   VOID RepaintWindow(B OR(WIN_WID[B]<<WIDSHIFT))
   OTW_DrawMap B
+  IF WIN_CHILD[B]THEN
+   B=WIN_CHILD[B]
+   CONTINUE
+  ENDIF
   IF!WIN_NEXT[B]THEN
    WHILE B
     B=WIN_PARENT[B]
@@ -699,11 +853,11 @@
 end
 COMMON DEF GetWindowWidth(WND)
  IF!CheckWindow(WND)THEN RETURN -1
- RETURN WIN_FWIDTH[WND AND NUWIDMASK]
+ RETURN WIN_WIDTH[WND AND NUWIDMASK]-WIN_FW2[WND AND NUWIDMASK]
 END
 COMMON DEF GetWindowHeight(WND)
  IF!CheckWindow(WND)THEN RETURN -1
- RETURN WIN_FHEIGHT[WND AND NUWIDMASK]
+ RETURN WIN_HEIGHT[WND AND NUWIDMASK]-WIN_FH2[WND AND NUWIDMASK]
 END
 VAR WIN_DRAGHANDLER$
 VAR WIN_DRAGHANDLER_A1
@@ -733,27 +887,40 @@
  WIN_DRAGHANDLER_WND=0
  RETURN 0
 END
+VAR OTW_MOUSECLIPX
+VAR OTW_MOUSECLIPY
+VAR OTW_MOUSECLIPX2
+VAR OTW_MOUSECLIPY2
+DEF MouseClip X,Y,W,H
+ OTW_MOUSECLIPX=X
+ OTW_MOUSECLIPY=Y
+ OTW_MOUSECLIPX2=W+X
+ OTW_MOUSECLIPY2=H+Y
+END
+DEF MouseClipDef
+ MouseClip 0,0,400,240
+END
 ''WINDOW GRAPHIC
 COMMON DEF GBeginWindow(WND)
  IF!CheckWindow(WND)THEN RETURN WIN_INVALIDID
  VAR NUWID=WND AND NUWIDMASK
  IF WIN_BEGIN[NUWID]==1THEN RETURN WIN_EVENTERR
  WIN_BEGIN[NUWID]=TRUE
- VAR AX=WIN_FX[NUWID]
- VAR AY=WIN_FY[NUWID]
+ VAR AX=WIN_RFX[NUWID]'WIN_FW1[NUWID]
+ VAR AY=WIN_RFY[NUWID]'WIN_FH1[NUWID]
  VAR W=WIN_AW[NUWID]
  VAR H=WIN_AH[NUWID]
  GPAGE OTW_SP,OTW_BP
  GCLIP 1,AX,AY,AX+W,AY+H
- GCLS
+ GCLS -1
  RETURN 0
 END
 DEF ReGBeginWindow(WND)
  IF!CheckWindow(WND)THEN RETURN WIN_INVALIDID
  VAR NUWID=WND AND NUWIDMASK
  INC WIN_BEGIN[NUWID]
- VAR AX=WIN_FX[NUWID]
- VAR AY=WIN_FY[NUWID]
+ VAR AX=WIN_RFX[NUWID]'WIN_FW1[NUWID]
+ VAR AY=WIN_RFY[NUWID]':IN_FH1[NUWID]
  VAR W=WIN_AW[NUWID]
  VAR H=WIN_AH[NUWID]
  GPAGE OTW_SP,OTW_BP
@@ -765,8 +932,8 @@
  VAR NUWID=WND AND NUWIDMASK
  IF WIN_BEGIN[NUWID]THEN RETURN WIN_EVENTERR
  WIN_BEGIN[NUWID]=TRUE
- VAR AX=WIN_AX[NUWID]
- VAR AY=WIN_AY[NUWID]
+ VAR AX=WIN_RX[NUWID]
+ VAR AY=WIN_RY[NUWID]
  VAR W=WIN_WIDTH[NUWID]
  VAR H=WIN_HEIGHT[NUWID]
  GPAGE OTW_SP,OTW_BP
@@ -782,8 +949,8 @@
  WIN_PARENT[0]=0
  WIN_NEXT[0]=0
  WIN_BEGIN[NUWID]=FALSE
- VAR AX=WIN_AX[NUWID]
- VAR AY=WIN_AY[NUWID]
+ VAR AX=WIN_RX[NUWID]
+ VAR AY=WIN_RY[NUWID]
  VAR W=WIN_AW[NUWID]
  VAR H=WIN_AH[NUWID]
  GCLIP 1,AX,AY,AX+W,AY+H
@@ -791,7 +958,7 @@
  IF WIN_CHILD[NUWID]THEN
   PNUWID=WIN_CHILD[NUWID]
   WHILE PNUWID
-   GCOPY OTW_DP,WIN_AX[PNUWID],WIN_AY[PNUWID],WIN_AX[PNUWID]+WIN_WIDTH[PNUWID],WIN_AY[PNUWID]+WIN_HEIGHT[PNUWID],WIN_AX[PNUWID],WIN_AY[PNUWID],0
+   GCOPY OTW_DP,WIN_RX[PNUWID],WIN_RY[PNUWID],WIN_RX[PNUWID]+WIN_AW[PNUWID],WIN_RY[PNUWID]+WIN_AH[PNUWID],WIN_RX[PNUWID],WIN_RY[PNUWID],0
 
 'GCOPY OTW_DP,WIN_AX[PNUWID]+AX,WIN_AY[PNUWID]+AY,WIN_AX[PNUWID]+WIN_WIDTH[PNUWID],WIN_AY[PNUWID]+WIN_HEIGHT[PNUWID],WIN_AX[PNUWID]-AX,WIN_AY[PNUWID]-AY,0
 '   GCOPY OTW_DP,WIN_AX[PNUWID]+AX,WIN_AY[PNUWID]+AY,WIN_AX[PNUWID]+WIN_WIDTH[PNUWID],WIN_AY[PNUWID]+WIN_HEIGHT[PNUWID],0,0,0  
@@ -815,7 +982,7 @@
 ' ELSE
 '  GCOPY OTW_DP,WIN_AX[PNUWID]+AX,WIN_AY[PNUWID]+AY,WIN_AX[PNUWID]+WIN_WIDTH[PNUWID],WIN_AY[PNUWID]+WIN_HEIGHT[PNUWID],0,0,0
 ' ENDIF
-   GCOPY OTW_DP,WIN_AX[PNUWID],WIN_AY[PNUWID],WIN_AX[PNUWID]+WIN_WIDTH[PNUWID],WIN_AY[PNUWID]+WIN_HEIGHT[PNUWID],WIN_AX[PNUWID],WIN_AY[PNUWID],0
+   GCOPY OTW_DP,WIN_RX[PNUWID],WIN_RY[PNUWID],WIN_RX[PNUWID]+WIN_AW[PNUWID],WIN_RY[PNUWID]+WIN_AH[PNUWID],WIN_RX[PNUWID],WIN_RY[PNUWID],0
   _NUWID=PNUWID
   PNUWID=WIN_NEXT[PNUWID]
  WEND
@@ -915,6 +1082,8 @@
    SPVAR OTW_MOVWINSP,1,NUWID
    SPVAR OTW_MOVWINSP,2,AX-X
    SPVAR OTW_MOVWINSP,3,AY-Y
+   VAR PNUWID=WIN_PARENT[NUWID]
+   MouseClip WIN_FX[PNUWID],WIN_FY[PNUWID],WIN_WIDTH[PNUWID]-WIN_FW2[PNUWID],WIN_HEIGHT[PNUWID]-WIN_FH2[PNUWID]
   ENDIF
  ENDIF
 END
@@ -925,6 +1094,7 @@
  VAR E=MoveWindow(WND,X,Y)
  SPHIDE OTW_MOVWINSP
  SPUNLINK OTW_MOVWINSP
+ MouseClipDef
 END
 DEF ButtonPainter W,C,T,A1,A2
  VAR E=GBeginWindow(W)
@@ -968,11 +1138,13 @@
  IF!OTW_INIT THEN
   OTWRunning=TRUE
   OTW_FPS=1
+  OTW_FPSCNT=1
   'ACLS
   XSCREEN 2,512,2
   OTW_DP=4
   OTW_SP=0
   OTW_BP=1
+  MouseClipDef
   GPAGE OTW_SP,OTW_SP
   GPRIO 1023
   GCLS
@@ -1079,6 +1251,7 @@
 END
 VAR OTW_OLDLMOUSE
 VAR OTW_OLDRMOUSE
+VAR OTW_FDIFF
 COMMON DEF L_OTW
  VAR MOVEMOUSE
  UpdateMouse
@@ -1117,11 +1290,11 @@
  VOID UpdateWindow(TSTWND2)
  VOID UpdateWindow(TSTWND)
  VOID UpdateWindow(TSTWND3)
- VAR _CNT=MAINCNT-OTW_CNT
- IF _CNT>60 THEN
+ OTW_FDIFF=MAINCNT-OTW_CNT
+ IF OTW_FDIFF>60 THEN
   OTW_FPS=OTW_FPSCNT
   OTW_FPSCNT=0
-  ?OTW_FPS
+  '?OTW_FPS
   OTW_CNT=MAINCNT
  ELSE
   INC OTW_FPSCNT
@@ -1131,6 +1304,7 @@
 END
 VAR WCLOCKWND
 VAR WCLOCKBC
+VAR WCLOCKBC2
 VAR WCLOCKTIM
 COMMON DEF I_WCLOCK
  IF!CHKCALL("IsWinRunning")||!IsWinRunning()THEN
@@ -1143,7 +1317,8 @@
  WCLOCKTIM=MAINCNT/60
  WCLOCKTIM=WCLOCKTIM*60
  'NewWindow GetButtonControl()
- NewWindow TSTCTL,"TEST",8,8,64,64,WCLOCKWND,0 OUT WCLOCKBC,E
+ NewWindow TSTCTL,"TEST",8,8,32,32,WCLOCKWND,0 OUT WCLOCKBC,E
+ NewWindow TSTCTL,"TEST",16,16,32,32,WCLOCKWND,0 OUT WCLOCKBC2,E
 END
 COMMON DEF L_WCLOCK
  VAR E
@@ -1161,6 +1336,7 @@
   WCLOCKTIM=WCLOCKTIM*60
   WCLOCK_RP
  ENDIF
+ E=UpdateWindow(WCLOCKBC2)
  
 END
  DEF WCLOCK_RP
@@ -1170,6 +1346,7 @@
   GFILLWindow WCLOCKWND,0,0,64,64,RGB(255,160,16)
   GPRINTWindowCC WCLOCKWND,0,0,TIME$,1
   GPRINTWindowCC WCLOCKWND,0,8,TIME$,1
+  GPRINTWindowCC WCLOCKWND,0,56,TIME$,1
   E=GEndWindow(WCLOCKWND)
  END
 DEF DUMP_WND
@@ -1228,10 +1405,10 @@
  IF OTW_MOUSEOLDST AND S THEN
   OTW_MOUSEX=OTW_MOUSEX+X-OTW_MOUSEOLDX
   OTW_MOUSEY=OTW_MOUSEY+Y-OTW_MOUSEOLDY
-  IF OTW_MOUSEX<0THEN OTW_MOUSEX=0
-  IF OTW_MOUSEY<0THEN OTW_MOUSEY=0
-  IF OTW_MOUSEX>=400THEN OTW_MOUSEX=399
-  IF OTW_MOUSEY>=240THEN OTW_MOUSEY=239
+   IF OTW_MOUSEX<OTW_MOUSECLIPX THEN OTW_MOUSEX=OTW_MOUSECLIPX
+   IF OTW_MOUSEY<OTW_MOUSECLIPY THEN OTW_MOUSEY=OTW_MOUSECLIPY
+   IF OTW_MOUSEX>=OTW_MOUSECLIPX2 THEN OTW_MOUSEX=OTW_MOUSECLIPX2-1
+   IF OTW_MOUSEY>=OTW_MOUSECLIPY2 THEN OTW_MOUSEY=OTW_MOUSECLIPY2
   SPOFS OTW_MOUSESP,OTW_MOUSEX,OTW_MOUSEY
    OTW_MOUSEX#=OTW_MOUSEX
    OTW_MOUSEY#=OTW_MOUSEY
@@ -1245,10 +1422,10 @@
   IF X#!=0 OR Y#!=0 THEN
    OTW_MOUSEX#=OTW_MOUSEX#+X#*0.2'/2
    OTW_MOUSEY#=OTW_MOUSEY#-Y#*0.2'/2
-   IF OTW_MOUSEX#<0THEN OTW_MOUSEX#=0
-   IF OTW_MOUSEY#<0THEN OTW_MOUSEY#=0
-   IF OTW_MOUSEX#>=400THEN OTW_MOUSEX#=399
-   IF OTW_MOUSEY#>=240THEN OTW_MOUSEY#=239
+   IF OTW_MOUSEX#<OTW_MOUSECLIPX THEN OTW_MOUSEX#=OTW_MOUSECLIPX
+   IF OTW_MOUSEY#<OTW_MOUSECLIPY THEN OTW_MOUSEY#=OTW_MOUSECLIPY
+   IF OTW_MOUSEX#>=OTW_MOUSECLIPX2 THEN OTW_MOUSEX#=OTW_MOUSECLIPX2-1
+   IF OTW_MOUSEY#>=OTW_MOUSECLIPY2 THEN OTW_MOUSEY#=OTW_MOUSECLIPY2
    SPOFS OTW_MOUSESP,OTW_MOUSEX#,OTW_MOUSEY#
    OTW_MOUSEX=OTW_MOUSEX#
    OTW_MOUSEY=OTW_MOUSEY#
