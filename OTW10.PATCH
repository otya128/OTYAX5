diff -u OTW.TXT OTW10
--- OTW.TXT
+++ OTW10
@@ -268,6 +268,7 @@
  CTL_FREE=CTL_NEXT[CTL_FREE]
  CTL_CID[CTL AND 4095]=CTL_CIDCNT
  CTL_NEXT[CTL AND 4095]=0
+ CTL_NAME$[CTL AND 4095]=NAME$
 END
 COMMON DEF ExtendControl NAME$,PARENT OUT CTL,ERR
  IF!CheckControl(PARENT)THEN
@@ -398,7 +399,7 @@
  RETURN 2
 END
 COMMON DEF NewWindow CTL,NAME$,X,Y,WIDTH,HEIGHT,PARENT,FLG OUT WND,ERR
-  IF!CheckControl(CTL)THEN
+ IF!CheckControl(CTL)THEN
   WND=0
   ERR=CTL_INVALIDID
   RETURN
@@ -632,15 +633,15 @@
  NEXT
  IF WIN_CHILD[NUWID]THEN
   VAR C=WIN_CHILD[NUWID]
+  VAR D
   WHILE C
+   D=WIN_NEXT[C]
    E=DeleteWindowNUWID(C)
-   C=WIN_NEXT[NUWID]
+   C=D
   WEND
  ENDIF
  VAR N=WIN_NEXT[NUWID]
  VAR P=WIN_PREV[NUWID]
- WIN_NEXT[NUWID]=0
- WIN_PREV[NUWID]=0
  IF N THEN
   WIN_PREV[N]=P
  ENDIF
@@ -651,9 +652,16 @@
   WIN_CHILD[WIN_PARENT[NUWID]]=N
  ENDIF
  IF WIN_SP[NUWID]THEN
-  SPVAR WIN_SP[NUWID],0,0
-  SPCLR WIN_SP[NUWID]
+  SPVAR WIN_SP[NUWID]AND 511,0,0
+  SPCLR WIN_SP[NUWID]AND 511
+  WIN_SP[NUWID]=0
  ENDIF
+ WIN_NEXT[NUWID]=WIN_FREE
+ WIN_PREV[NUWID]=0
+ WIN_PARENT[NUWID]=0
+ WIN_CHILD[NUWID]=0
+ WIN_FREE=NUWID
+ WIN_NAME$[NUWID]=""
  RETURN 0
 END
 
@@ -665,7 +673,7 @@
  I=1022+255
  WHILE NUWID
   I=I-Z
-  SPOFS WIN_SP[NUWID]AND 1023,,,-255+I
+  SPOFS WIN_SP[NUWID]AND 511,,,-255+I
 '  SPOFS (WIN_SP[NUWID]>>10),,,-255+I+1
   NUWID=WIN_NEXT[NUWID]
  WEND
@@ -704,10 +712,10 @@
     WIN_NEXT[NUWID]=0
     IF WIN_PARENT[NUWID]==(WIN_ROOTWND AND NUWIDMASK) THEN
      VAR Z,Z2,S
-     SPOFS WIN_SP[NUWID]AND 1023OUT S,S,Z
-     SPOFS WIN_SP[C]AND 1023OUT S,S,Z2
-     SPOFS WIN_SP[NUWID]AND 1023,,,Z2
-     SPOFS WIN_SP[C]AND 1023,,,Z
+     SPOFS WIN_SP[NUWID]AND 511OUT S,S,Z
+     SPOFS WIN_SP[C]AND 511OUT S,S,Z2
+     SPOFS WIN_SP[NUWID]AND 511,,,Z2
+     SPOFS WIN_SP[C]AND 511,,,Z
     ENDIF
     VOID RepaintWindow(WND)
     OTW_DrawMap NUWID
@@ -757,7 +765,7 @@
      WHILE B
       B=WIN_PARENT[B]
   '    IF B==NXT THEN BREAK
-      IF WIN_NEXT[B]THEN B=WIN_NEXT[B]BREAK
+      IF WIN_NEXT[B]THEN BREAK
      WEND
      IF!B THEN RETURN
  '    IF B==NXT THEN BREAK
@@ -846,8 +854,7 @@
  B=NXT
  IF WIN_PARENT[NUWID]==(WIN_ROOTWND AND NUWIDMASK) THEN
   IF WIN_SP[NUWID]THEN
-   SPCHR WIN_SP[NUWID] AND 1023,WIN_AX[NUWID],WIN_AY[NUWID],WIN_WIDTH[NUWID]+1,WIN_HEIGHT[NUWID]+1,1
-   SPOFS WIN_SP[NUWID] AND 1023,WIN_AX[NUWID],WIN_AY[NUWID]
+   WIN_SP[NUWID]=WIN_SP[NUWID] OR 512
   ENDIF
  ENDIF
  OTW_DrawMap WIN_PARENT[NUWID]
@@ -1013,7 +1020,7 @@
  @END
  VAR B=WIN_CHILD[NUWID]
  WHILE B
-  VAR E=UpdateWindowOnly(B OR B<<WIDSHIFT)
+  VAR E=UpdateWindowOnly(B OR WIN_WID[B]<<WIDSHIFT)
   IF!WIN_NEXT[B]THEN
    WHILE B
     B=WIN_PARENT[B]
@@ -1193,8 +1200,13 @@
  GPAGE OTW_SP,OTW_DP
  GCLIP 1,0,0,400,240
  GCOPY OTW_BP,AX,AY,AX+W,AY+H,AX,AY,0
+ IF WIN_SP[NUWID]AND 512THEN OTW_SPCHR NUWID
  RETURN 0
 END
+DEF OTW_SPCHR NUWID
+ SPCHR WIN_SP[NUWID] AND 511,WIN_AX[NUWID],WIN_AY[NUWID],WIN_WIDTH[NUWID]+1,WIN_HEIGHT[NUWID]+1,1
+ SPOFS WIN_SP[NUWID] AND 511,WIN_AX[NUWID],WIN_AY[NUWID]
+END
 COMMON DEF GPSETWindow WND,X,Y,COL
  VAR AX=WIN_FX[WND AND NUWIDMASK]
  VAR AY=WIN_FY[WND AND NUWIDMASK]
@@ -1318,7 +1330,6 @@
  IF X>=W-9THEN
   IF BTN AND CTL_BTNUPFLG THEN
    VAR E=DeleteWindow(WND)
-   ?E
   ENDIF
   RETURN
  ENDIF
@@ -1701,6 +1712,7 @@
  ExtendControl "RUN",GetWindowControl() OUT RUNCTL,E
  VAR WND
  NewTopLevelWindow RUNCTL,"RUN",64,32 OUT WND,E
+ IF E THEN BEEP:ExitProcess 1
  E=SetControlNotificationHandler(RUNCTL,"RunNotificationHandler")
  SetProcessVar WND
  VAR TW
@@ -1709,7 +1721,7 @@
 END
 COMMON DEF L_RUN
  VAR E=UpdateWindow(GetProcessVar())
- IF E THEN ExitProcess 1
+ IF E THEN ExitProcess 0
 END
 VAR ABOUTCTL
 COMMON DEF I_ABOUT
@@ -1722,6 +1734,7 @@
  ExtendControl "ABOUT",GetWindowControl() OUT ABOUTCTL,E
  VAR WND
  NewTopLevelWindow ABOUTCTL,"OTW",128,32 OUT WND,E
+ IF E THEN BEEP:ExitProcess 1
  SetProcessVar WND
  E=SetControlPainter(ABOUTCTL,"AboutPainter")
 END
@@ -1855,9 +1868,8 @@
 END
 DEF DUMP_WND2 NUW,I$
  IF!NUW THEN RETURN
- ?I$;WIN_NAME$[NUW],NUW,WIN_WID[NUW]
+ ?I$;WIN_NAME$[NUW],NUW,WIN_WID[NUW],CTL_NAME$[WIN_CTL[NUW]AND 4095],WIN_CTL[NUW]AND 4095
 ' IF CSRY==29 THEN VAR II$INPUT "";II$
- DUMP_WND2 WIN_NEXT[NUW],I$
  IF LEN(I$) THEN
   VAR NM$=""
   IF WIN_NEXT[NUW] THEN
@@ -1878,6 +1890,7 @@
    DUMP_WND2 WIN_CHILD[NUW],"îŠš"
   ENDIF
  ENDIF
+ DUMP_WND2 WIN_NEXT[NUW],I$
 END
 DEF UpdateButton()
  VAR B=BUTTON()
